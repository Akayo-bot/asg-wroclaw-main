/* === Sparkle Navbar для Админ Панели === */

/* Палитра для dropdown */
:root {
  --acc: #00ff88;
  --acc-soft: rgba(0,255,136,.24);
  --acc-soft-2: rgba(0,255,136,.14);
  --txt: #e6edea;
  --muted: #bfc7c1;
  --panel-top: rgba(14,16,15,.78);
  --panel-bot: rgba(12,20,16,.62);
  --bd: rgba(0,255,136,.12);
  --danger: #ff273a;
  --danger-soft: rgba(255,39,58,.28);
}

/* Корневой контейнер */
.sparkle-nav {
  --acc: #00ff88;                    /* зелёный акцент */
  --fg:  #dfe7e1;                    /* базовый текст */
  --bg1: rgba(10,10,10,.95);         /* верх градиента (почти непрозрачный) */
  --bg2: rgba(10,18,14,.90);         /* низ градиента (почти непрозрачный) */
  --bd:  rgba(0,255,136,.12);        /* тонкая рамка снизу */
  --glow: rgba(0,255,136,.24);       /* мягкое свечение */
  --nav-h: 72px;                     /* фиксированная высота (увеличена для полоски) */

  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 100;
  min-height: var(--nav-h);          /* Резерв высоты */
  isolation: isolate;                /* слои не протекают */
  pointer-events: none;              /* Отключаем клики по навбару */
}

/* СИЛЬНЫЙ blur слой для контента за navbar */
.sparkle-nav::after {
  content: '';
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,0.4);      /* Более сильное затемнение */
  backdrop-filter: blur(20px) saturate(120%);  /* ОЧЕНЬ сильный blur */
  -webkit-backdrop-filter: blur(20px) saturate(120%);
  z-index: -1;
  pointer-events: none;
}

/* GLASS-подложка — лежит ПОД спарками */
.sparkle-nav__glass {
  position: absolute;
  inset: 0;
  background: linear-gradient(to bottom, var(--bg1), var(--bg2));
  backdrop-filter: blur(24px) saturate(160%);  /* ОЧЕНЬ сильный blur */
  -webkit-backdrop-filter: blur(24px) saturate(160%);
  border-bottom: 1px solid var(--bd);
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.05),
    0 6px 30px rgba(0,0,0,.45);
  z-index: 0;                        /* ниже всего */
  pointer-events: none;
}

/* Контентный слой */
.sparkle-nav__inner {
  position: relative;
  z-index: 10;                     /* Поверх спарков */
  max-width: 100%;
  margin: 0 auto;
  height: var(--nav-h);               /* Фиксированная высота */
  pointer-events: auto !important;    /* Включаем клики на внутренних элементах */
  padding: 12px 24px;
  display: flex;
  align-items: center;
  gap: 20px;
  color: var(--fg);
  pointer-events: auto !important;  /* Включаем кликабельность */
}

/* Все интерактивные элементы внутри навбара должны быть кликабельными */
.sparkle-nav__inner *,
.sparkle-nav__inner button,
.sparkle-nav__inner a {
  pointer-events: auto !important;
}

/* Спарки — ПОВЕРХ контента, но не мешают кликам */
.sparkle-layer {
  position: absolute;
  inset: 0;
  z-index: 0;
  pointer-events: none;
  mix-blend-mode: screen;            /* красиво "поджигает" неон */
  overflow: hidden;
}

/* Декоративная градиентная линия внизу */
.sparkle-nav__gradient-line {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 1px;
  background: linear-gradient(to right, transparent, var(--acc), transparent);
  opacity: 0.5;
  pointer-events: none;
}

/* Левая секция - Лого */
.sparkle-nav__logo {
  display: flex;
  align-items: center;
  gap: 12px;
  text-decoration: none;
  transition: filter .25s ease;
}

.sparkle-nav__logo:hover {
  filter: drop-shadow(0 0 8px var(--glow));
}

.sparkle-nav__logo-icon {
  width: 32px;
  height: 32px;
  border-radius: 8px;
  background: linear-gradient(to bottom right, #00ff88, #00cc6a);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  font-size: 14px;
  color: #0a0a0a;
  box-shadow: 0 0 12px var(--glow);
}

.sparkle-nav__logo-text {
  color: var(--fg);
  font-weight: 600;
  font-size: 18px;
}

/* Центральная секция - Navigation Links */
.sparkle-nav__links {
  position: relative;                  /* Для позиционирования полоски */
  flex: 1;
  display: flex;
  justify-content: center;
  align-items: center;
  gap: clamp(16px, 2.4vw, 24px);
}

/* Центральная секция - User Info (для админ панели) */
.sparkle-nav__user-info {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 6px 12px;
  border-radius: 10px;
  background: rgba(255,255,255,.03);
  border: 1px solid rgba(255,255,255,.08);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  transition: all .25s ease;
}

.sparkle-nav__user-info:hover {
  background: rgba(255,255,255,.05);
  border-color: rgba(0,255,136,.2);
  box-shadow: 0 0 16px var(--glow);
}

.sparkle-nav__user-name {
  color: var(--fg);
  font-weight: 500;
  font-size: 14px;
  line-height: 1.2;
}

.sparkle-nav__user-role {
  color: rgba(223,231,225,.6);
  font-size: 12px;
  line-height: 1.2;
  text-transform: capitalize;
}

/* Правый блок - Actions */
.sparkle-nav__right {
  margin-left: auto;
  display: flex;
  align-items: center;
  gap: 12px;
}

/* Линки с неоновым эффектом — Green Neon + Glass */
.nav-link {
  /* палитра */
  --link-bg:        #07150d;
  --link-bg-2:      #0b1e14;
  --link-border:    #153725;
  --link-text:      #d7f5e6;
  --link-neon:      #00ff88;
  --link-neon-soft: rgba(0,255,136,.32);
  --link-neon-hard: rgba(0,255,136,.55);
  --px: 16px;                         /* резерв под padding */
  --py: 9px;                          /* резерв под padding */

  position: relative;
  z-index: 1;
  display: inline-flex;
  align-items: center;
  white-space: nowrap;
  gap: 6px;
  padding: var(--py) var(--px);
  color: var(--link-text);
  text-decoration: none;
  border-radius: 6px;
  cursor: pointer;
  line-height: 1;                     /* фикс метрик строки */

  /* Резервация! border существует сразу */
  border: 1px solid var(--link-border);
  background: linear-gradient(to bottom, var(--link-bg), var(--link-bg-2));
  background-clip: padding-box;

  /* лёгкий внутренний объём */
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,0.06),
    inset 0 0 4px rgba(0,255,136,0.06);

  /* анимация только безопасных свойств */
  transition:
    color .25s ease,
    border-color .25s ease,
    box-shadow .25s ease,
    filter .25s ease,
    transform .1s ease,
    opacity .25s ease;
  
  will-change: filter, transform;
}

/* капсула существует сразу, но невидима */
.nav-link::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: 6px;
  opacity: 0;                          /* только opacity на hover */
  background: linear-gradient(to bottom, rgba(9,22,15,.55), rgba(9,30,20,.45));
  border: 1px solid rgba(0,255,136,.10);
  box-shadow: 
    inset 0 1px 0 rgba(255,255,255,.06), 
    inset 0 0 8px rgba(0,255,136,.08);
  pointer-events: none;
  transition: opacity .25s ease, box-shadow .25s ease;
}

/* hover — только opacity, не меняет layout */
.nav-link:hover::before {
  opacity: 1;
  box-shadow: 
    0 0 8px var(--link-neon-soft),
    inset 0 0 12px rgba(0,255,136,0.12);
}

/* hover — зелёный неон + лёгкая "корона" вокруг */
.nav-link:hover {
  color: var(--link-neon);
  border-color: var(--link-neon);
  box-shadow:
    0 0 8px var(--link-neon-soft),
    inset 0 0 6px rgba(0,255,136,0.12);
  filter: drop-shadow(0 0 4px var(--link-neon-soft));
}

/* небольшое смещение при клике, как у реальной кнопки */
.nav-link:active {
  transform: translateY(1px) scale(0.99);
  box-shadow:
    0 0 12px var(--link-neon-hard),
    inset 0 0 8px rgba(0,255,136,0.18);
}

/* Активная страница — только цвет (анимированная линия остаётся) */
.nav-link.is-active {
  color: var(--link-neon);
}

/* доступность: кольцо фокуса */
.nav-link:focus-visible {
  outline: none;
  border-color: var(--link-neon);
  box-shadow:
    0 0 0 3px rgba(0,255,136,0.25),
    inset 0 0 6px rgba(0,255,136,0.18);
}

/* Адаптация для маленьких экранов */
@media (max-width: 640px) {
  .sparkle-nav__inner {
    padding: 12px 16px;
    gap: 12px;
  }

  .sparkle-nav__user-info {
    display: none;
  }
}

/* Анимированная полоска - ИДЕНТИЧНО ОРИГИНАЛУ */
.active-element {
  --active-element-scale-x: 1;
  --active-element-scale-y: 1;
  --active-element-show: 0;
  --active-element-opacity: 1;
  --active-element-width: 0px;
  --active-element-strike-x: 0%;
  --active-element-mask-position: 0%;
  
  position: absolute;
  left: 0;
  top: 42px;
  height: 3px;
  width: 36px;
  border-radius: 2px;
  background-color: var(--acc);
  opacity: var(--active-element-show);
  will-change: transform, opacity;
  pointer-events: none;
}

.active-element > svg,
.active-element .strike {
  position: absolute;
  right: 0;
  top: 50%;
  transform: translateY(-50%);
  opacity: var(--active-element-opacity);
  width: var(--active-element-width);
  mix-blend-mode: multiply;
}

.active-element > svg {
  display: block;
  overflow: visible;
  height: 5px;
  filter: blur(0.5px) 
    drop-shadow(2px 0px 8px rgba(0,255,136,0.25)) 
    drop-shadow(1px 0px 2px rgba(0,255,136,0.5)) 
    drop-shadow(0px 0px 3px rgba(0,255,136,0.25)) 
    drop-shadow(2px 0px 8px rgba(0,255,136,0.27)) 
    drop-shadow(8px 0px 16px rgba(0,255,136,0.31));
}

.active-element .strike {
  padding: 24px 0;
  -webkit-mask-image: linear-gradient(
    to right, 
    transparent calc(0% + var(--active-element-mask-position)), 
    black calc(15% + var(--active-element-mask-position)), 
    black 80%, 
    transparent
  );
  mask-image: linear-gradient(
    to right, 
    transparent calc(0% + var(--active-element-mask-position)), 
    black calc(15% + var(--active-element-mask-position)), 
    black 80%, 
    transparent
  );
}

.active-element .strike svg {
  display: block;
  overflow: visible;
  height: 12px;
  width: calc(var(--active-element-width) * 2);
  transform: translate(var(--active-element-strike-x), 30%) 
    scale(var(--active-element-scale-x), var(--active-element-scale-y));
}

.active-element .strike svg:last-child {
  transform: translate(var(--active-element-strike-x), -30%) scale(-1);
}

.active-element .strike svg g path:nth-child(2) {
  filter: blur(2px);
}

.active-element .strike svg g path:nth-child(3) {
  filter: blur(4px);
}

/* Direction classes */
.sparkle-nav__links.before .active-element {
  transform: rotateY(180deg);
}

.sparkle-nav__links.after .active-element {
  transform: rotateY(0deg);
}

/* Motion-опция */
@media (prefers-reduced-motion: reduce) {
  .sparkle-nav * {
    transition: none !important;
    filter: none !important;
    text-shadow: none !important;
    animation: none !important;
  }
  .active-element {
    display: none;
  }
}

/* Sparkle animations для декоративного слоя */
@keyframes sparkle-float {
  0% { transform: translateY(0) scale(1); opacity: 0; }
  50% { opacity: 1; }
  100% { transform: translateY(-100px) scale(0.5); opacity: 0; }
}

.sparkle-particle {
  position: absolute;
  width: 4px;
  height: 4px;
  background: var(--acc);
  border-radius: 50%;
  box-shadow: 0 0 8px var(--acc), 0 0 16px var(--acc);
  animation: sparkle-float 3s ease-in-out infinite;
  pointer-events: none;
}

/* ========================================
   === Dropdown стили для языка, профиля, гамбургера ===
   ======================================== */

/* Контейнер дропа */
.dropdown {
  position: relative;
}

/* Кнопки-триггеры */
.btn-icon, .btn-avatar {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 8px 12px;
  color: var(--txt);
  background: transparent;
  border: 1px solid rgba(255,255,255,.08);
  border-radius: 12px;
  transition: color .2s ease, border-color .2s ease, box-shadow .2s ease, transform .15s ease;
  backdrop-filter: blur(4px) saturate(120%);
  position: relative;
  z-index: 100;                      /* Поверх всего */
  pointer-events: auto;              /* Включаем кликабельность */
  cursor: pointer;
}
.btn-icon:hover, .btn-avatar:hover {
  color: var(--acc);
  border-color: var(--acc-soft-2);
  box-shadow: 0 0 10px var(--acc-soft-2);
  transform: translateY(-1px);
}

/* Аватар */
.btn-avatar img {
  width: 28px;
  height: 28px;
  border-radius: 9999px;
  object-fit: cover;
  box-shadow: 0 0 0 2px rgba(255,255,255,.08), 0 0 8px var(--acc-soft-2);
}
.btn-avatar .name {
  font-weight: 600;
}

/* Выпадающее меню — стекло */
.menu-panel {
  position: absolute;
  right: 0;
  top: calc(100% + 8px);
  min-width: 180px;
  border-radius: 12px;
  border: 1px solid var(--bd);
  background: linear-gradient(to bottom, var(--panel-top), var(--panel-bot));
  box-shadow:
    0 10px 30px rgba(0,0,0,.45),
    inset 0 1px 0 rgba(255,255,255,.05);
  backdrop-filter: blur(10px) saturate(140%);
  -webkit-backdrop-filter: blur(10px) saturate(140%);
  padding: 6px;
  color: var(--txt);
  pointer-events: auto;
  z-index: 80;
  /* Анимация теперь управляется через framer-motion */
}

/* Пункт меню */
.menu-item {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.6rem;
  padding: 10px 12px;
  color: var(--txt);
  background: transparent;
  border: 1px solid transparent;
  border-radius: 10px;
  text-align: center;
  transition: color .2s, background .2s, box-shadow .2s, transform .15s;
}

/* Активный вариант (как в языках) */
.menu-item.is-active {
  color: #0b1e14;
  background: linear-gradient(to bottom, #0de49a, #09c67f);
  box-shadow: 0 0 18px var(--acc-soft), inset 0 0 10px rgba(0,0,0,.15);
}

/* Hover-пилюля + неон */
.menu-item:hover {
  color: var(--acc);
  background: linear-gradient(to bottom, rgba(9,22,15,.55), rgba(9,30,20,.45));
  border-color: var(--acc-soft-2);
  box-shadow:
    inset 0 0 15px rgba(0,255,136,.25),
    0 0 20px var(--acc-soft),
    0 0 30px rgba(0,255,136,.2),
    0 0 0 2px rgba(0,255,136,.3);
  transform: translateY(-1px);
}

/* Разделитель */
.sep {
  height: 1px;
  margin: 6px 0;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,.12), transparent);
}

/* Языковые теги слева (UA, RU, …) */
.menu-item .tag {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 30px;
  padding: 4px 8px;
  font-weight: 700;
  border-radius: 6px;
  color: #0b1e14;
  background: linear-gradient(to bottom, #0de49a, #09c67f);
  box-shadow: 0 0 10px var(--acc-soft);
}

/* Иконки */
.mi {
  width: 18px;
  height: 18px;
  display: inline-block;
}
.mi-user {
  background: no-repeat center/contain url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" stroke="%23cfd6d2" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M12 14c2.21 0 4 1.79 4 4H2c0-2.21 1.79-4 4-4h6z"/><circle cx="8" cy="6" r="4"/></svg>');
}
.mi-exit {
  background: no-repeat center/contain url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" stroke="%23ff6673" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M10 12H3m4 4v1a2 2 0 1 0 4 0v-1M11 4V3a2 2 0 1 0-4 0v1"/><path d="M13 9l3 3-3 3"/></svg>');
}

/* Коронка с мягким неоном */
.mi-crown {
  background: no-repeat center/contain url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="%23ffd54a" viewBox="0 0 24 24"><path d="M5 16l-2-9 6 4 3-6 3 6 6-4-2 9H5z"/><path fill="%23000000" fill-opacity=".18" d="M5 16h14v2H5z"/></svg>');
  filter: drop-shadow(0 0 10px rgba(255,213,74,.5)) drop-shadow(0 0 15px rgba(255,213,74,.4));
}
/* усиленный зелёный неон вокруг короны */
.mi-neon {
  filter:
    drop-shadow(0 0 10px var(--acc-soft))
    drop-shadow(0 0 20px var(--acc-soft))
    drop-shadow(0 0 30px rgba(0,255,136,.3));
}

/* Опасный пункт (Выйти) */
.menu-item.danger {
  color: #ff9aa5;
}
.menu-item.danger:hover {
  color: #fff;
  background: linear-gradient(to bottom, rgba(26,0,0,.6), rgba(26,0,0,.45));
  border-color: rgba(255,39,58,.2);
  box-shadow:
    inset 0 0 10px rgba(255,39,58,.18),
    0 0 12px var(--danger-soft);
}

/* Доступность */
.menu-item:focus-visible {
  outline: none;
  box-shadow: 0 0 0 2px var(--acc-soft);
}

/* Motion-respect */
@media (prefers-reduced-motion: reduce) {
  .btn-icon, .btn-avatar, .menu-item, .menu-panel {
    transition: none !important;
    transform: none !important;
  }
}

/* ========================================
   === МОБИЛЬНАЯ ВЕРСИЯ ===
   ======================================== */

@media (max-width: 1024px) {
  /* Скрываем десктопные ссылки */
  .sparkle-nav__links {
    display: none;
  }

  /* Отображаем мобильные кнопки */
  .sparkle-nav__right {
    gap: 0.5rem;
  }

  /* Уменьшаем размер кнопок */
  .btn-icon, .btn-avatar {
    padding: 6px 10px;
    font-size: 0.875rem;
  }

  /* Уменьшаем аватар */
  .btn-avatar img {
    width: 24px;
    height: 24px;
  }

  .btn-avatar .name {
    display: none; /* Скрываем имя на мобильной */
  }

  /* Dropdown menu для мобильной версии */
  .menu-panel {
    min-width: 200px;
    max-width: 90vw;
    right: 0;
    left: auto;
  }

  /* Центральные ссылки в мобильном меню */
  .sparkle-nav__links .nav-link {
    padding: 12px 16px;
    font-size: 0.9rem;
  }
}

/* Для очень маленьких экранов */
@media (max-width: 640px) {
  .sparkle-nav__inner {
    padding: 0.75rem 1rem;
  }

  .sparkle-nav__logo-text {
    font-size: 0.9rem;
  }

  .btn-icon, .btn-avatar {
    padding: 5px 8px;
    font-size: 0.8rem;
  }

  /* Увеличиваем кнопки на мобильной */
  .btn-icon {
    min-width: 44px;             /* Минимальная ширина для touch */
    min-height: 44px;             /* Минимальная высота для touch */
    padding: 12px;               /* Увеличиваем padding */
    font-size: 1.2rem;            /* Увеличиваем иконку */
  }

  .btn-avatar {
    min-width: 44px;             /* Минимальная ширина для touch */
    min-height: 44px;            /* Минимальная высота для touch */
    padding: 8px 12px;           /* Увеличиваем padding */
  }

  .btn-avatar img {
    width: 32px;                  /* Увеличиваем аватар */
    height: 32px;
  }

  .btn-avatar .name {
    display: none;
  }

  .menu-panel {
    min-width: 180px;
    max-width: calc(100vw - 32px);
  }

  .menu-item {
    padding: 8px 10px;
    font-size: 0.85rem;
  }

  /* Активный элемент в мобильном меню */
  .menu-item.is-active {
    background: linear-gradient(to bottom, #0de49a, #09c67f);
    color: #0b1e14;
    box-shadow: 0 0 18px var(--acc-soft), inset 0 0 10px rgba(0,0,0,.15);
  }
}
